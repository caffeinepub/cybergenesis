{
  "kind": "build_request",
  "title": "Apply brute-force 3D background diagnostic: camera far=2000, red basic material, sphere radius=500",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "In `frontend/src/components/CubeVisualization.tsx`, update `SceneSetup` to also configure the scene camera for the diagnostic test by setting `camera.far = 2000` (when the camera is a `THREE.PerspectiveCamera`) and calling `camera.updateProjectionMatrix()` so the background sphere cannot be clipped by the far plane.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "### DIAGNOSTIC TEST: STOP FOG AND RADIUS ISSUES\n\n1. **Camera Check:** In `SceneSetup`, ensure `camera.far` is set to `2000`. (If it's 50, the sphere is invisible)."
        ]
      },
      "acceptanceCriteria": [
        "When rendering `CubeVisualization`, the active PerspectiveCamera has `far` set to 2000 and the projection matrix is updated (verified via console/logging or runtime inspection)."
      ]
    },
    {
      "id": "REQ-2",
      "text": "In `frontend/src/components/CubeVisualization.tsx`, modify the `BackgroundSphere` diagnostic implementation to bypass the custom shader material entirely and instead render the sphere with `<meshBasicMaterial color=\"red\" side={THREE.BackSide} fog={false} />`.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "2. **Material Overdrive:** In `BackgroundSphere.tsx`, completely bypass the shader for a second. Change the material to a basic one:\n   `<meshBasicMaterial color=\"red\" side={THREE.BackSide} fog={false} />`"
        ]
      },
      "acceptanceCriteria": [
        "`BackgroundSphere` uses `THREE.MeshBasicMaterial` (via `meshBasicMaterial`) with solid red color, `side=THREE.BackSide`, and `fog={false}`.",
        "The custom `THREE.ShaderMaterial` background gradient is not used during this diagnostic test."
      ]
    },
    {
      "id": "REQ-3",
      "text": "In `frontend/src/components/CubeVisualization.tsx`, increase the background sphere size for the diagnostic test by changing the `SphereGeometry` radius from `50` to `500` (keeping the geometry inverted so the inside is visible).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "3. **Scale:** Increase sphere radius from `50` to `500`."
        ]
      },
      "acceptanceCriteria": [
        "`BackgroundSphere` creates an inverted `THREE.SphereGeometry` with radius 500.",
        "The sphere remains `renderOrder={-1}` and `frustumCulled={false}` so it is always drawn behind the scene."
      ]
    }
  ],
  "constraints": [
    "Do not edit files under `frontend/src/hooks/useInternetIdentity.ts`, `frontend/src/hooks/useInternetIdentity.tsx`, `frontend/src/hooks/useActor.ts`, `frontend/src/main.tsx`, or anything in `frontend/src/components/ui` (immutable paths).",
    "Keep all changes limited to implementing the requested brute-force diagnostic (no unrelated refactors).",
    "Use English for any user-facing text."
  ],
  "nonGoals": [
    "Do not attempt to fix or redesign the custom shader math beyond bypassing it for the diagnostic test.",
    "Do not add new rendering features or post-processing beyond what is required for the diagnostic validation.",
    "Do not change backend canister logic."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}